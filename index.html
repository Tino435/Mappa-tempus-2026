<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>I Luoghi della Festa - Tempus 2026</title>
    
    <script src="https://unpkg.com/@panzoom/panzoom@4.5.1/dist/panzoom.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/image-map-resizer/1.0.10/js/imageMapResizer.min.js"></script>

    <style>
        :root { --medieval-blue: #2c3e50; --gold: #f1c40f; --parchment: #e0d7c6; }
        
        body { margin: 0; display: flex; height: 100vh; font-family: 'Georgia', serif; background: var(--parchment); overflow: hidden; }
        
        /* Sidebar Legenda */
        .sidebar { width: 320px; background: var(--medieval-blue); color: white; padding: 20px; overflow-y: auto; z-index: 10; box-shadow: 2px 0 15px rgba(0,0,0,0.5); flex-shrink: 0; }
        .sidebar h2 { font-size: 1.2rem; border-bottom: 2px solid var(--gold); padding-bottom: 10px; color: var(--gold); text-transform: uppercase; }
        .sidebar h3 { font-size: 0.9rem; color: #aaa; margin-top: 25px; text-transform: uppercase; border-bottom: 1px solid #444; }
        
        .legend-list { padding: 0; list-style: none; }
        .legend-item { cursor: pointer; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1); font-size: 0.9rem; transition: 0.2s; }
        .legend-item:hover { color: var(--gold); padding-left: 8px; }

        /* Area Mappa */
        .map-viewport { flex-grow: 1; position: relative; overflow: hidden; background: #ccd5de; cursor: grab; display: flex; justify-content: center; align-items: center; }
        .map-viewport:active { cursor: grabbing; }
        #panzoom-element { width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; }
        #panzoom-element img { max-width: none; height: 90vh; display: block; }

        /* Popup Modale */
        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); }
        .modal-content { background: #fdfaf0; margin: 10% auto; padding: 30px; width: 85%; max-width: 450px; border-radius: 8px; text-align: center; border: 5px solid var(--medieval-blue); position: relative; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .close { position: absolute; right: 15px; top: 10px; font-size: 35px; cursor: pointer; color: var(--medieval-blue); font-weight: bold; }
        
        /* Mobile adjustment */
        @media (max-width: 768px) {
            body { flex-direction: column; }
            .sidebar { width: 100%; height: 30%; order: 2; }
            .map-viewport { height: 70%; order: 1; }
        }
    </style>
</head>
<body>

<div class="sidebar">
    <h2>I Luoghi della Festa</h2>
    <ul class="legend-list">
        <li class="legend-item" onclick="showInfo('Antro et Locanda de lo Duomo', 'Ristoro medievale situato sotto le volte del Duomo.')">‚ù∂ Antro et Locanda de lo Duomo</li>
        <li class="legend-item" onclick="showInfo('Cort dal Diaul', 'Punto di ristoro suggestivo tra le mura storiche.')">‚ù∑ Cort dal Diaul</li>
        <li class="legend-item" onclick="showInfo('Cervogeria de lo Eretico', 'Produzione artigianale di birre ed elisir.')">‚ù∏ Cervogeria de lo Eretico</li>
        <li class="legend-item" onclick="showInfo('Taberna de lo Rospo', 'Osteria tipica per viandanti e cavalieri.')">‚ùπ Taberna de lo Rospo</li>
        <li class="legend-item" onclick="showInfo('Porta Paninorum', 'Antico varco ora sede di sapori tradizionali.')">‚ù∫ Porta Paninorum</li>
        <li class="legend-item" onclick="showInfo('Taberna Pane et Salamen', 'Specialit√† locali e taglieri del borgo.')">‚ùª Taberna Pane et Salamen</li>
    </ul>

    <h3>Eventi e Servizi</h3>
    <ul class="legend-list">
        <li class="legend-item" onclick="showInfo('Incendio del Campanile', 'Grande spettacolo pirotecnico ogni sera.')">‚òÖ Incendio del Campanile</li>
        <li class="legend-item" onclick="showInfo('Palio del Niederlech', 'Venerd√¨ 1: La storica sfida delle contrade.')">üèÅ Palio del Niederlech</li>
        <li class="legend-item" onclick="showInfo('Cambio Monete', 'Cambia qui i tuoi Euro in moneta medievale.')">üí∞ Cambio Monete</li>
        <li class="legend-item" onclick="showInfo('Infopoint', 'Informazioni e WC con fasciatoio.')">‚ìò Infopoint</li>
        <li class="legend-item" onclick="showInfo('Accampamento', 'Vita quotidiana, tende e addestramento armigeri.')">‚õ∫ Accampamento</li>
    </ul>
</div>

<div class="map-viewport">
    <div id="panzoom-element">

<img src="Cartografia_TEMPUS.jpg" usemap="#image-map">

<map name="image-map">
    <area target="" alt="Salvacondotto" title="Salvacondotto" href="" coords="4234,1053,87" shape="circle">
    <area target="" alt="Mercati" title="Mercati" href="" coords="3832,1222,55" shape="circle">
    <area target="" alt="WC" title="WC" href="" coords="4033,1285,49" shape="circle">
    <area target="" alt="Corte dei nobili" title="Corte dei nobili" href="" coords="3704,1456,61" shape="circle">
    <area target="" alt="Piazza del Duomo" title="Piazza del Duomo" href="" coords="3674,1031,75" shape="circle">
</map>
    </div>
</div>

<div id="infoModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2 id="modal-title" style="color:var(--medieval-blue); margin-top:0;"></h2>
        <hr style="border:0; border-top:1px solid #ccc; margin:15px 0;">
        <p id="modal-text" style="line-height:1.6; color:#444; font-size: 1.1rem;"></p>
    </div>
</div>

<script>
    // 1. Inizializzazione Zoom
    const elem = document.getElementById('panzoom-element');
    const panzoom = Panzoom(elem, {
        maxScale: 5,
        minScale: 1,
        contain: 'outside',
        startScale: 1
    });

    // Abilita zoom con rotellina
    elem.parentElement.addEventListener('wheel', panzoom.zoomWithWheel);

    // 2. Funzione Popup
    function showInfo(title, text) {
        document.getElementById('modal-title').innerText = title;
        document.getElementById('modal-text').innerText = text;
        document.getElementById('infoModal').style.display = "block";
    }

    function closeModal() {
        document.getElementById('infoModal').style.display = "none";
    }

    // 3. Gestione Coordinate Responsive
    window.onload = function() {
        imageMapResize(); // Rende i clic precisi anche dopo lo zoom o ridimensionamento
    };

    // Chiudi modale cliccando fuori
    window.onclick = function(event) {
        if (event.target == document.getElementById('infoModal')) closeModal();
    }
</script>

</body>
</html>